<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Farm Control - ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --primary-color: #2e7d32;
            --secondary-color: #0288d1;
            --danger-color: #d32f2f;
            --bg-color: #f4f7f6;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            text-align: center;
            width: 90%;
            max-width: 400px;
        }

        h1 { color: var(--primary-color); margin-bottom: 0.5rem; }
        p { color: #666; margin-bottom: 2rem; }

        .status-card {
            background: #e3f2fd;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .moisture-label { font-size: 1rem; color: #555; }
        .moisture-value { 
            font-size: 3.5rem; 
            font-weight: 600; 
            color: var(--secondary-color);
            margin: 10px 0;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        button {
            flex: 1;
            padding: 12px;
            font-size: 1rem;
            font-family: 'Kanit', sans-serif;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-on { background-color: var(--primary-color); color: white; }
        .btn-off { background-color: var(--danger-color); color: white; }

        button:hover { opacity: 0.9; transform: translateY(-2px); }
        button:active { transform: translateY(0); }

        .indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .online { background-color: #4caf50; box-shadow: 0 0 8px #4caf50; }
    </style>
</head>
<body>

<div class="container">
    <h1>Smart Farm üåø</h1>
    <p><span class="indicator online"></span> ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</p>

    <div class="status-card">
        <div class="moisture-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÉ‡∏ô‡∏î‡∏¥‡∏ô</div>
        <div class="moisture-value"><span id="moisture">--</span>%</div>
    </div>

    <div class="btn-group">
        <button class="btn-on" onclick="controlPump(true)">‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥</button>
        <button class="btn-off" onclick="controlPump(false)">‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥</button>
    </div>
    
    <p style="margin-top: 20px; font-size: 0.8rem;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡πä‡∏°: <span id="p-status">‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà</span></p>
</div>

<script>
    // --- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç CONFIG ---
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        databaseURL: "YOUR_DATABASE_URL",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID"
    };
    // --- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç CONFIG ---

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏à‡∏≤‡∏Å Firebase ‡πÅ‡∏ö‡∏ö Real-time
    db.ref("moisture").on("value", (snapshot) => {
        const val = snapshot.val();
        document.getElementById("moisture").innerText = val !== null ? val : "--";
        
        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô
        const moistureElement = document.getElementById("moisture");
        if(val < 30) moistureElement.style.color = "#d32f2f"; // ‡πÅ‡∏´‡πâ‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
        else if(val > 70) moistureElement.style.color = "#0288d1"; // ‡∏ä‡∏∏‡πà‡∏°‡∏â‡πà‡∏≥
        else moistureElement.style.color = "#2e7d32"; // ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏µ
    });

    // ‡∏î‡∏∂‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡πä‡∏°‡∏°‡∏≤‡πÇ‡∏ä‡∏ß‡πå‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    db.ref("pumpStatus").on("value", (snapshot) => {
        const status = snapshot.val();
        document.getElementById("p-status").innerText = status ? "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏î‡∏ô‡πâ‡∏≥..." : "‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà";
        document.getElementById("p-status").style.color = status ? "#2e7d32" : "#d32f2f";
    });

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î
    function controlPump(status) {
        db.ref("/").update({
            pumpStatus: status
        }).then(() => {
            console.log("‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + status);
        }).catch((error) => {
            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message);
        });
    }
</script>

</body>
</html>
